2022-12-19 14:41:22.660  INFO 85800 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 85800 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 14:41:22.666  INFO 85800 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 14:41:23.647  INFO 85800 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 14:41:23.760  INFO 85800 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 106 ms. Found 1 JPA repository interfaces.
2022-12-19 14:41:24.642  INFO 85800 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 14:41:24.652  INFO 85800 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 14:41:24.652  INFO 85800 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 14:41:24.767  INFO 85800 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 14:41:24.768  INFO 85800 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2043 ms
2022-12-19 14:41:24.811  INFO 85800 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 14:41:25.084  INFO 85800 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 14:41:25.102  INFO 85800 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 14:41:25.290  INFO 85800 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 14:41:25.333  INFO 85800 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 14:41:25.439  INFO 85800 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 14:41:25.502  INFO 85800 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 14:41:26.190  INFO 85800 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 14:41:26.195  INFO 85800 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 14:41:26.424  INFO 85800 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 14:41:26.427  INFO 85800 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 14:41:26.428  INFO 85800 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 14:41:26.428  INFO 85800 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 14:41:26.428  INFO 85800 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 14:41:26.428  INFO 85800 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 14:41:26.438  INFO 85800 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 14:41:26.439  INFO 85800 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 14:41:26.439  INFO 85800 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 14:41:26.440  INFO 85800 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 14:41:26.856  WARN 85800 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 14:41:27.371  INFO 85800 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 14:41:27.793  INFO 85800 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 14:41:28.093  INFO 85800 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 14:41:28.103  INFO 85800 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 14:41:28.119  INFO 85800 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 14:41:28.121  INFO 85800 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 14:41:28.126  INFO 85800 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 14:41:28.252  INFO 85800 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 14:41:28.252  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 14:41:28.268  INFO 85800 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 6.042 seconds (JVM running for 9.118)
2022-12-19 14:41:28.273  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 14:41:28.273  INFO 85800 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 14:41:28.289  INFO 85800 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=10} for segment: Segment[0/0]
2022-12-19 14:41:28.290  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=10} for segment: Segment[0/0]
2022-12-19 14:54:19.149  INFO 85800 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 14:54:19.157  INFO 85800 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 14:54:19.242  INFO 85800 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 85 ms
2022-12-19 14:54:19.660  INFO 85800 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 002
2022-12-19 14:54:19.884  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 8d2926c0-38fe-4578-ad37-086a8debef5f
2022-12-19 14:54:19.885  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 002
2022-12-19 14:54:20.038 ERROR 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred
2022-12-19 14:54:20.050 ERROR 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [25c0c69d-ec02-4c0d-aa2f-64a28e9b49f3] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:60) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 14:54:36.961  INFO 85800 --- [CommandProcessor-1] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 002
2022-12-19 14:54:37.042  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 84f253b6-6a79-4696-8563-8ecea322711d
2022-12-19 14:54:37.048  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 002
2022-12-19 14:54:37.140 ERROR 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred
2022-12-19 14:54:37.144 ERROR 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [7612abed-b8a2-483d-bd7a-6d2ca13e48ac] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:60) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 14:55:25.941  INFO 85800 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 14:55:25.943  INFO 85800 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 14:55:25.961  INFO 85800 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 14:55:25.962  INFO 85800 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 14:55:26.589  INFO 85800 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 14:55:26.589  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 14:55:26.592  INFO 85800 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 14:55:26.593  INFO 85800 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 14:55:26.615  INFO 85800 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 14:55:26.615  INFO 85800 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 14:55:26.892  INFO 85800 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 14:55:26.899  INFO 85800 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 14:55:26.955  INFO 85800 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 14:55:32.195  INFO 87442 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 87442 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 14:55:32.201  INFO 87442 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 14:55:33.330  INFO 87442 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 14:55:33.462  INFO 87442 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 114 ms. Found 1 JPA repository interfaces.
2022-12-19 14:55:34.322  INFO 87442 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 14:55:34.331  INFO 87442 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 14:55:34.331  INFO 87442 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 14:55:34.478  INFO 87442 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 14:55:34.479  INFO 87442 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2224 ms
2022-12-19 14:55:34.521  INFO 87442 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 14:55:34.809  INFO 87442 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 14:55:34.841  INFO 87442 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 14:55:35.077  INFO 87442 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 14:55:35.117  INFO 87442 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 14:55:35.266  INFO 87442 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 14:55:35.415  INFO 87442 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 14:55:36.422  INFO 87442 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 14:55:36.429  INFO 87442 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 14:55:36.610  INFO 87442 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 14:55:36.617  INFO 87442 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 14:55:36.617  INFO 87442 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 14:55:36.617  INFO 87442 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 14:55:36.617  INFO 87442 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 14:55:36.617  INFO 87442 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 14:55:36.626  INFO 87442 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 14:55:36.627  INFO 87442 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 14:55:36.628  INFO 87442 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 14:55:36.628  INFO 87442 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 14:55:36.943  WARN 87442 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 14:55:37.806  INFO 87442 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 14:55:39.240  INFO 87442 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 14:55:39.737  INFO 87442 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 14:55:39.749  INFO 87442 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 14:55:39.806  INFO 87442 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 14:55:39.814  INFO 87442 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 14:55:39.822  INFO 87442 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 14:55:40.000  INFO 87442 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 14:55:40.000  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 14:55:40.014  INFO 87442 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 14:55:40.014  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 14:55:40.024  INFO 87442 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 8.323 seconds (JVM running for 9.559)
2022-12-19 14:55:40.029  INFO 87442 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=12} for segment: Segment[0/0]
2022-12-19 14:55:40.029  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=12} for segment: Segment[0/0]
2022-12-19 14:55:58.759  INFO 87442 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 14:55:58.762  INFO 87442 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 14:55:58.785  INFO 87442 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 23 ms
2022-12-19 14:55:59.524  INFO 87442 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 002
2022-12-19 14:55:59.806  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 4c1b6ce4-a20f-42f6-bf25-7c2152d827aa
2022-12-19 14:55:59.808  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 002
2022-12-19 14:56:00.258 ERROR 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred
2022-12-19 14:56:00.289 ERROR 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [3f911eee-dfca-473a-b9af-a5120acb4f25] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:60) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 14:56:50.139  INFO 87442 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 14:56:50.143  INFO 87442 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 14:56:50.162  INFO 87442 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 14:56:50.163  INFO 87442 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 14:56:51.178  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 14:56:51.178  INFO 87442 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 14:56:51.180  INFO 87442 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 14:56:51.180  INFO 87442 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 14:56:51.209  INFO 87442 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 14:56:51.211  INFO 87442 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 14:56:51.539  INFO 87442 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 14:56:51.545  INFO 87442 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 14:56:51.568  INFO 87442 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 14:56:58.721  INFO 87605 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 87605 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 14:56:58.723  INFO 87605 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 14:56:59.603  INFO 87605 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 14:56:59.697  INFO 87605 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 87 ms. Found 1 JPA repository interfaces.
2022-12-19 14:57:00.645  INFO 87605 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 14:57:00.653  INFO 87605 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 14:57:00.653  INFO 87605 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 14:57:00.776  INFO 87605 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 14:57:00.776  INFO 87605 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2004 ms
2022-12-19 14:57:00.819  INFO 87605 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 14:57:01.074  INFO 87605 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 14:57:01.090  INFO 87605 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 14:57:01.239  INFO 87605 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 14:57:01.268  INFO 87605 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 14:57:01.359  INFO 87605 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 14:57:01.416  INFO 87605 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 14:57:01.949  INFO 87605 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 14:57:01.956  INFO 87605 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 14:57:02.101  INFO 87605 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 14:57:02.104  INFO 87605 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 14:57:02.105  INFO 87605 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 14:57:02.105  INFO 87605 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 14:57:02.105  INFO 87605 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 14:57:02.105  INFO 87605 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 14:57:02.112  INFO 87605 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 14:57:02.113  INFO 87605 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 14:57:02.113  INFO 87605 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 14:57:02.114  INFO 87605 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 14:57:02.408  WARN 87605 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 14:57:02.807  INFO 87605 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 14:57:03.158  INFO 87605 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 14:57:03.342  INFO 87605 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 14:57:03.351  INFO 87605 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 14:57:03.362  INFO 87605 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 14:57:03.364  INFO 87605 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 14:57:03.368  INFO 87605 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 14:57:03.441  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 14:57:03.441  INFO 87605 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 14:57:03.455  INFO 87605 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.114 seconds (JVM running for 6.112)
2022-12-19 14:57:03.455  INFO 87605 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 14:57:03.455  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 14:57:03.468  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=13} for segment: Segment[0/0]
2022-12-19 14:57:03.468  INFO 87605 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=13} for segment: Segment[0/0]
2022-12-19 14:57:08.592  INFO 87605 --- [http-nio-9091-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 14:57:08.593  INFO 87605 --- [http-nio-9091-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 14:57:08.603  INFO 87605 --- [http-nio-9091-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 10 ms
2022-12-19 14:57:08.802  INFO 87605 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 002
2022-12-19 14:57:08.886  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 7f9956de-c58b-4637-a7c5-ff44d16acbbf
2022-12-19 14:57:08.887  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 002
2022-12-19 14:57:09.011 ERROR 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> org.axonframework.queryhandling.QueryExecutionException: com.airscholar.CommonService.queries.GetUserPaymentDetailsQuery
2022-12-19 14:57:09.020 ERROR 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [5c1a1e73-5b67-4f5c-a710-69aa1baf48ea] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:60) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 14:57:22.434  INFO 87605 --- [CommandProcessor-1] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 14:57:22.466  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 423947b0-ff94-411f-b11e-f828b33631b7
2022-12-19 14:57:22.467  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 14:57:22.513 ERROR 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> org.axonframework.queryhandling.QueryExecutionException: com.airscholar.CommonService.queries.GetUserPaymentDetailsQuery
2022-12-19 14:57:22.515 ERROR 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [3ee024f0-4ba9-4ad8-b39f-fd7095040f13] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:60) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:02:21.201  INFO 87605 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:02:21.254  INFO 87605 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:02:21.366  INFO 87605 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:02:21.366  INFO 87605 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:02:22.253  INFO 87605 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:02:22.253  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:02:22.256  INFO 87605 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:02:22.256  INFO 87605 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:02:22.311  INFO 87605 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:02:22.324  INFO 87605 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:02:23.544  INFO 87605 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:02:23.584  INFO 87605 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:02:23.689  INFO 87605 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:13:00.432  INFO 89462 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 89462 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:13:00.440  INFO 89462 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:13:01.423  INFO 89462 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:13:01.527  INFO 89462 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 97 ms. Found 1 JPA repository interfaces.
2022-12-19 15:13:02.402  INFO 89462 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:13:02.409  INFO 89462 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:13:02.410  INFO 89462 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:13:02.534  INFO 89462 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:13:02.535  INFO 89462 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2039 ms
2022-12-19 15:13:02.571  INFO 89462 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:13:02.822  INFO 89462 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:13:02.839  INFO 89462 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:13:02.985  INFO 89462 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:13:03.016  INFO 89462 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:13:03.120  INFO 89462 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:13:03.210  INFO 89462 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:13:03.782  INFO 89462 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:13:03.787  INFO 89462 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:13:03.941  INFO 89462 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:13:03.944  INFO 89462 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:13:03.944  INFO 89462 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:13:03.944  INFO 89462 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:13:03.944  INFO 89462 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:13:03.944  INFO 89462 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:13:03.952  INFO 89462 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:13:03.953  INFO 89462 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:13:03.953  INFO 89462 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:13:03.953  INFO 89462 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:13:04.282  WARN 89462 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:13:04.809  INFO 89462 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:13:05.258  INFO 89462 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:13:05.435  INFO 89462 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:13:05.442  INFO 89462 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:13:05.456  INFO 89462 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:13:05.458  INFO 89462 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:13:05.462  INFO 89462 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:13:05.551  INFO 89462 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:13:05.551  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:13:05.567  INFO 89462 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:13:05.567  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:13:05.567  INFO 89462 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.65 seconds (JVM running for 6.872)
2022-12-19 15:13:05.577  INFO 89462 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=15} for segment: Segment[0/0]
2022-12-19 15:13:05.577  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=15} for segment: Segment[0/0]
2022-12-19 15:13:17.500  INFO 89462 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:13:17.502  INFO 89462 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:13:17.513  INFO 89462 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 11 ms
2022-12-19 15:13:17.862  INFO 89462 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:13:18.026  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 1fffe203-76ed-4186-bba5-5e024ca3219c
2022-12-19 15:13:18.026  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 15:13:18.029 ERROR 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> Cannot invoke "com.airscholar.CommonService.data.UserRepository.findById(Object)" because "this.userRepository" is null
2022-12-19 15:13:18.040 ERROR 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [6b0662f7-5a83-451e-8abf-eda352fd42b5] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:65) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:15:33.593  INFO 89462 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:15:33.598  INFO 89462 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:15:33.661  INFO 89462 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:15:33.661  INFO 89462 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:15:34.446  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:15:34.446  INFO 89462 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:15:34.449  INFO 89462 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:15:34.449  INFO 89462 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:15:34.510  INFO 89462 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:15:34.511  INFO 89462 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:15:35.040  INFO 89462 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:15:35.048  INFO 89462 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:15:35.061  INFO 89462 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:15:43.998  INFO 89768 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 89768 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:15:44.003  INFO 89768 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:15:45.017  INFO 89768 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:15:45.107  INFO 89768 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 84 ms. Found 1 JPA repository interfaces.
2022-12-19 15:15:45.967  INFO 89768 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:15:45.974  INFO 89768 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:15:45.974  INFO 89768 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:15:46.092  INFO 89768 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:15:46.092  INFO 89768 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2029 ms
2022-12-19 15:15:46.129  INFO 89768 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:15:46.426  INFO 89768 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:15:46.448  INFO 89768 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:15:46.609  INFO 89768 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:15:46.638  INFO 89768 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:15:46.728  INFO 89768 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:15:46.784  INFO 89768 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:15:47.312  INFO 89768 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:15:47.319  INFO 89768 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:15:47.456  INFO 89768 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:15:47.459  INFO 89768 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:15:47.459  INFO 89768 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:15:47.459  INFO 89768 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:15:47.459  INFO 89768 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:15:47.459  INFO 89768 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:15:47.467  INFO 89768 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:15:47.467  INFO 89768 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:15:47.467  INFO 89768 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:15:47.468  INFO 89768 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:15:47.778  WARN 89768 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:15:48.195  INFO 89768 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:15:48.545  INFO 89768 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:15:48.744  INFO 89768 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:15:48.751  INFO 89768 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:15:48.761  INFO 89768 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:15:48.764  INFO 89768 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:15:48.767  INFO 89768 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:15:48.849  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:15:48.851  INFO 89768 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:15:48.873  INFO 89768 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:15:48.873  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:15:48.871  INFO 89768 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.532 seconds (JVM running for 6.597)
2022-12-19 15:15:48.884  INFO 89768 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=16} for segment: Segment[0/0]
2022-12-19 15:15:48.884  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=16} for segment: Segment[0/0]
2022-12-19 15:15:55.469  INFO 89768 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:15:55.470  INFO 89768 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:15:55.475  INFO 89768 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2022-12-19 15:15:55.628  INFO 89768 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:15:55.751  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 72bbcb25-befa-44f7-8fcb-8a3107f8aff6
2022-12-19 15:15:55.752  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 15:15:55.754 ERROR 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> Cannot invoke "com.airscholar.CommonService.data.UserRepository.findById(Object)" because "this.userRepository" is null
2022-12-19 15:15:55.760 ERROR 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [d38e577e-9cd4-414f-ae68-e878eab5152d] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:65) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:17:27.200  INFO 89768 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:17:27.204  INFO 89768 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:17:27.226  INFO 89768 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:17:27.227  INFO 89768 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:17:27.612  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:17:27.612  INFO 89768 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:17:27.615  INFO 89768 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:17:27.616  INFO 89768 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:17:27.682  INFO 89768 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:17:27.688  INFO 89768 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:17:28.505  INFO 89768 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:17:28.538  INFO 89768 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:17:28.574  INFO 89768 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:17:36.824  INFO 89975 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 89975 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:17:36.828  INFO 89975 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:17:38.021  INFO 89975 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:17:38.127  INFO 89975 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 98 ms. Found 1 JPA repository interfaces.
2022-12-19 15:17:38.910  INFO 89975 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:17:38.917  INFO 89975 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:17:38.917  INFO 89975 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:17:39.024  INFO 89975 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:17:39.024  INFO 89975 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2140 ms
2022-12-19 15:17:39.061  INFO 89975 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:17:39.315  INFO 89975 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:17:39.332  INFO 89975 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:17:39.500  INFO 89975 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:17:39.530  INFO 89975 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:17:39.623  INFO 89975 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:17:39.681  INFO 89975 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:17:40.204  INFO 89975 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:17:40.211  INFO 89975 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:17:40.359  INFO 89975 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:17:40.362  INFO 89975 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:17:40.362  INFO 89975 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:17:40.362  INFO 89975 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:17:40.362  INFO 89975 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:17:40.362  INFO 89975 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:17:40.370  INFO 89975 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:17:40.370  INFO 89975 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:17:40.371  INFO 89975 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:17:40.371  INFO 89975 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:17:40.664  WARN 89975 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:17:41.075  INFO 89975 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:17:41.435  INFO 89975 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:17:41.663  INFO 89975 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:17:41.672  INFO 89975 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:17:41.687  INFO 89975 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:17:41.689  INFO 89975 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:17:41.696  INFO 89975 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:17:41.773  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:17:41.773  INFO 89975 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:17:41.789  INFO 89975 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:17:41.789  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:17:41.798  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=17} for segment: Segment[0/0]
2022-12-19 15:17:41.798  INFO 89975 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=17} for segment: Segment[0/0]
2022-12-19 15:17:41.799  INFO 89975 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.473 seconds (JVM running for 7.0)
2022-12-19 15:17:49.266  INFO 89975 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:17:49.267  INFO 89975 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:17:49.272  INFO 89975 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2022-12-19 15:17:49.424  INFO 89975 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:17:49.544  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: cda919fb-dd2a-4525-8ad0-19bb6ec01185
2022-12-19 15:17:49.545  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 15:17:49.546 ERROR 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> Cannot invoke "com.airscholar.CommonService.data.UserRepository.findById(Object)" because "this.userRepository" is null
2022-12-19 15:17:49.554 ERROR 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [9b98952e-2ada-4bb3-bb05-fd9c01f3dc2c] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:66) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:22:51.077  INFO 89975 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:22:51.115  INFO 89975 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:22:51.376  INFO 89975 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:22:51.381  INFO 89975 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:22:51.969  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:22:51.969  INFO 89975 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:22:51.983  INFO 89975 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:22:51.983  INFO 89975 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:22:52.051  INFO 89975 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:22:52.055  INFO 89975 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:22:53.154  INFO 89975 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:22:53.177  INFO 89975 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:22:53.235  INFO 89975 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:23:06.730  INFO 90571 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 90571 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:23:06.734  INFO 90571 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:23:07.720  INFO 90571 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:23:07.825  INFO 90571 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 99 ms. Found 1 JPA repository interfaces.
2022-12-19 15:23:08.640  INFO 90571 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:23:08.646  INFO 90571 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:23:08.646  INFO 90571 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:23:08.747  INFO 90571 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:23:08.747  INFO 90571 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1962 ms
2022-12-19 15:23:08.782  INFO 90571 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:23:09.016  INFO 90571 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:23:09.033  INFO 90571 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:23:09.173  INFO 90571 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:23:09.202  INFO 90571 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:23:09.291  INFO 90571 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:23:09.353  INFO 90571 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:23:09.890  INFO 90571 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:23:09.897  INFO 90571 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:23:10.059  INFO 90571 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:23:10.062  INFO 90571 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:23:10.063  INFO 90571 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:23:10.063  INFO 90571 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:23:10.063  INFO 90571 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:23:10.063  INFO 90571 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:23:10.070  INFO 90571 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:23:10.071  INFO 90571 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:23:10.071  INFO 90571 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:23:10.072  INFO 90571 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:23:10.371  WARN 90571 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:23:10.771  INFO 90571 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:23:11.142  INFO 90571 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:23:11.330  INFO 90571 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:23:11.337  INFO 90571 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:23:11.348  INFO 90571 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:23:11.352  INFO 90571 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:23:11.357  INFO 90571 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:23:11.442  INFO 90571 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:23:11.443  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:23:11.461  INFO 90571 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:23:11.461  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:23:11.468  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=18} for segment: Segment[0/0]
2022-12-19 15:23:11.468  INFO 90571 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=18} for segment: Segment[0/0]
2022-12-19 15:23:11.469  INFO 90571 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.159 seconds (JVM running for 6.809)
2022-12-19 15:23:35.227  INFO 90571 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:23:35.229  INFO 90571 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:23:35.235  INFO 90571 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms
2022-12-19 15:23:35.504  INFO 90571 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:23:35.888  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: f2e0e57a-df60-425d-b893-f4d1f29b45c0
2022-12-19 15:23:35.902  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 15:23:35.914 ERROR 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> Cannot invoke "com.airscholar.CommonService.service.UserService.getUserById(String)" because "this.userService" is null
2022-12-19 15:23:35.935 ERROR 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [58444fa5-3081-4d99-929f-90da1df6dd3d] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:63) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:26:31.284  INFO 90571 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:26:31.292  INFO 90571 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:26:31.326  INFO 90571 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:26:31.326  INFO 90571 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:26:31.605  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:26:31.605  INFO 90571 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:26:31.609  INFO 90571 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:26:31.609  INFO 90571 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:26:31.677  INFO 90571 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:26:31.679  INFO 90571 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:26:32.325  INFO 90571 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:26:32.350  INFO 90571 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:26:32.368  INFO 90571 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:26:40.916  INFO 90971 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 90971 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:26:40.924  INFO 90971 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:26:43.605  INFO 90971 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:26:44.119  INFO 90971 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 498 ms. Found 1 JPA repository interfaces.
2022-12-19 15:26:45.343  INFO 90971 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:26:45.350  INFO 90971 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:26:45.350  INFO 90971 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:26:45.487  INFO 90971 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:26:45.487  INFO 90971 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 4340 ms
2022-12-19 15:26:45.526  INFO 90971 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:26:45.778  INFO 90971 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:26:45.804  INFO 90971 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:26:45.949  INFO 90971 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:26:45.985  INFO 90971 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:26:46.084  INFO 90971 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:26:46.146  INFO 90971 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:26:46.752  INFO 90971 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:26:46.760  INFO 90971 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:26:46.928  INFO 90971 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:26:46.932  INFO 90971 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.UserService].
2022-12-19 15:26:46.932  INFO 90971 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:26:46.932  INFO 90971 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:26:46.932  INFO 90971 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:26:46.932  INFO 90971 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:26:46.932  INFO 90971 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:26:46.940  INFO 90971 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:26:46.941  INFO 90971 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:26:46.941  INFO 90971 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:26:46.942  INFO 90971 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:26:47.251  WARN 90971 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userService' defined in file [/Users/airscholar/IdeaProjects/OrderApp/CommonService/target/classes/com/airscholar/CommonService/service/UserService.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.airscholar.CommonService.data.UserRepository' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
2022-12-19 15:26:47.253  INFO 90971 --- [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:26:47.255  INFO 90971 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:26:47.269  INFO 90971 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:26:47.271  INFO 90971 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2022-12-19 15:26:47.290  INFO 90971 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-12-19 15:26:47.308 ERROR 90971 --- [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in com.airscholar.CommonService.service.UserService required a bean of type 'com.airscholar.CommonService.data.UserRepository' that could not be found.


Action:

Consider defining a bean of type 'com.airscholar.CommonService.data.UserRepository' in your configuration.

2022-12-19 15:27:26.239  INFO 91056 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 91056 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:27:26.244  INFO 91056 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:27:27.222  INFO 91056 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:27:27.370  INFO 91056 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 139 ms. Found 1 JPA repository interfaces.
2022-12-19 15:27:28.116  INFO 91056 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:27:28.135  INFO 91056 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:27:28.135  INFO 91056 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:27:28.238  INFO 91056 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:27:28.239  INFO 91056 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1932 ms
2022-12-19 15:27:28.278  INFO 91056 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:27:28.510  INFO 91056 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:27:28.524  INFO 91056 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:27:28.727  INFO 91056 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:27:28.759  INFO 91056 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:27:28.854  INFO 91056 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:27:28.916  INFO 91056 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:27:29.462  INFO 91056 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:27:29.467  INFO 91056 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:27:29.602  INFO 91056 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:27:29.736  INFO 91056 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.UserService].
2022-12-19 15:27:29.736  INFO 91056 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:27:29.736  INFO 91056 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:27:29.736  INFO 91056 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:27:29.736  INFO 91056 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:27:29.736  INFO 91056 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:27:29.745  INFO 91056 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:27:29.745  INFO 91056 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:27:29.745  INFO 91056 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:27:29.746  INFO 91056 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:27:30.043  WARN 91056 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'userService' defined in file [/Users/airscholar/IdeaProjects/OrderApp/CommonService/target/classes/com/airscholar/CommonService/service/UserService.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type 'com.airscholar.CommonService.data.UserRepository' available: expected at least 1 bean which qualifies as autowire candidate. Dependency annotations: {}
2022-12-19 15:27:30.045  INFO 91056 --- [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:27:30.047  INFO 91056 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:27:30.088  INFO 91056 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:27:30.090  INFO 91056 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2022-12-19 15:27:30.108  INFO 91056 --- [main] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
2022-12-19 15:27:30.124 ERROR 91056 --- [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 0 of constructor in com.airscholar.CommonService.service.UserService required a bean of type 'com.airscholar.CommonService.data.UserRepository' that could not be found.


Action:

Consider defining a bean of type 'com.airscholar.CommonService.data.UserRepository' in your configuration.

2022-12-19 15:27:40.488  INFO 91093 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 91093 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:27:40.493  INFO 91093 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:27:41.417  INFO 91093 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:27:41.576  INFO 91093 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 151 ms. Found 1 JPA repository interfaces.
2022-12-19 15:27:42.346  INFO 91093 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:27:42.353  INFO 91093 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:27:42.353  INFO 91093 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:27:42.468  INFO 91093 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:27:42.468  INFO 91093 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1869 ms
2022-12-19 15:27:42.512  INFO 91093 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:27:42.736  INFO 91093 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:27:42.751  INFO 91093 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:27:42.953  INFO 91093 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:27:42.981  INFO 91093 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:27:43.072  INFO 91093 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:27:43.128  INFO 91093 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:27:43.657  INFO 91093 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:27:43.665  INFO 91093 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:27:43.807  INFO 91093 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:27:43.934  INFO 91093 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:27:43.935  INFO 91093 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:27:43.935  INFO 91093 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:27:43.935  INFO 91093 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:27:43.935  INFO 91093 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:27:43.943  INFO 91093 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:27:43.944  INFO 91093 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:27:43.944  INFO 91093 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:27:43.945  INFO 91093 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:27:44.254  WARN 91093 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:27:44.664  INFO 91093 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:27:45.057  INFO 91093 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:27:45.302  INFO 91093 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:27:45.310  INFO 91093 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:27:45.319  INFO 91093 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:27:45.321  INFO 91093 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:27:45.325  INFO 91093 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:27:45.405  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:27:45.405  INFO 91093 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:27:45.420  INFO 91093 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.376 seconds (JVM running for 6.311)
2022-12-19 15:27:45.420  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:27:45.420  INFO 91093 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:27:45.432  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=19} for segment: Segment[0/0]
2022-12-19 15:27:45.432  INFO 91093 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=19} for segment: Segment[0/0]
2022-12-19 15:27:58.680  INFO 91093 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:27:58.684  INFO 91093 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:27:58.705  INFO 91093 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 20 ms
2022-12-19 15:27:58.894  INFO 91093 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:27:59.025  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: a23a1e29-9a49-45d3-a827-cacfef6806fa
2022-12-19 15:27:59.026  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 15:27:59.028 ERROR 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Exception Occurred=> Cannot invoke "com.airscholar.CommonService.service.UserService.getUserById(String)" because "this.userService" is null
2022-12-19 15:27:59.034 ERROR 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [559e9974-926d-44af-a1f0-ba12381679b1] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

java.lang.NullPointerException: Cannot invoke "com.airscholar.CommonService.data.User.getCardDetails()" because "user" is null
	at com.airscholar.OrderService.command.api.saga.OrderProcessingSaga.handle(OrderProcessingSaga.java:67) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]
	at org.axonframework.messaging.annotation.AnnotatedMessageHandlingMember.handle(AnnotatedMessageHandlingMember.java:153) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.SagaMethodMessageHandlingMember.handle(SagaMethodMessageHandlingMember.java:80) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.annotation.WrappedMessageHandlingMember.handle(WrappedMessageHandlingMember.java:64) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.lambda$handle$1(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.TracingHandlerEnhancerDefinition$1.handle(TracingHandlerEnhancerDefinition.java:84) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$8(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.Scope.executeWithResult(Scope.java:111) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:121) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AnnotatedSaga.lambda$handle$7(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at org.axonframework.modelling.saga.AnnotatedSaga.handle(AnnotatedSaga.java:113) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.doInvokeSaga(AbstractSagaManager.java:181) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.startNewSaga(AbstractSagaManager.java:122) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.lambda$handle$4(AbstractSagaManager.java:106) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.modelling.saga.AbstractSagaManager.handle(AbstractSagaManager.java:105) ~[axon-modelling-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.MultiEventHandlerInvoker.handle(MultiEventHandlerInvoker.java:91) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$null$1(AbstractEventProcessor.java:173) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:57) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.interceptors.CorrelationDataInterceptor.handle(CorrelationDataInterceptor.java:67) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.tracing.Span.runCallable(Span.java:103) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$3(TrackingEventProcessor.java:185) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$new$1(TrackingEventProcessor.java:179) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.DefaultInterceptorChain.proceed(DefaultInterceptorChain.java:55) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.lambda$processInUnitOfWork$2(AbstractEventProcessor.java:184) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:92) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:31:26.120  INFO 91093 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:31:26.129  INFO 91093 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:31:26.160  INFO 91093 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:31:26.160  INFO 91093 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:31:26.507  INFO 91093 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:31:26.507  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:31:26.509  INFO 91093 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:31:26.509  INFO 91093 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:31:26.555  INFO 91093 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:31:26.558  INFO 91093 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:31:26.707  INFO 91093 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:31:26.723  INFO 91093 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:31:26.746  INFO 91093 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:31:33.879  INFO 91501 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 91501 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:31:33.884  INFO 91501 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:31:34.928  INFO 91501 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:31:35.074  INFO 91501 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 139 ms. Found 1 JPA repository interfaces.
2022-12-19 15:31:35.801  INFO 91501 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:31:35.808  INFO 91501 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:31:35.808  INFO 91501 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:31:35.928  INFO 91501 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:31:35.928  INFO 91501 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1932 ms
2022-12-19 15:31:35.963  INFO 91501 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:31:36.183  INFO 91501 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:31:36.199  INFO 91501 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:31:36.395  INFO 91501 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:31:36.428  INFO 91501 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:31:36.527  INFO 91501 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:31:36.588  INFO 91501 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:31:37.153  INFO 91501 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:31:37.160  INFO 91501 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:31:37.312  INFO 91501 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:31:37.434  INFO 91501 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:31:37.434  INFO 91501 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:31:37.434  INFO 91501 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:31:37.435  INFO 91501 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:31:37.435  INFO 91501 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:31:37.444  INFO 91501 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:31:37.445  INFO 91501 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:31:37.445  INFO 91501 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:31:37.445  INFO 91501 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:31:37.764  WARN 91501 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:31:38.177  INFO 91501 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:31:38.546  INFO 91501 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:31:38.746  INFO 91501 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:31:38.754  INFO 91501 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:31:38.766  INFO 91501 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:31:38.768  INFO 91501 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:31:38.770  INFO 91501 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:31:38.857  INFO 91501 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:31:38.857  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:31:38.874  INFO 91501 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:31:38.874  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:31:38.877  INFO 91501 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.433 seconds (JVM running for 6.319)
2022-12-19 15:31:38.880  INFO 91501 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=20} for segment: Segment[0/0]
2022-12-19 15:31:38.880  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=20} for segment: Segment[0/0]
2022-12-19 15:31:57.508  INFO 91501 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:31:57.509  INFO 91501 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:31:57.517  INFO 91501 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 7 ms
2022-12-19 15:31:57.958  INFO 91501 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:31:58.222  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: da2e1fc3-7223-4c19-8e6c-8e8f78aac6e3
2022-12-19 15:31:58.223  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 15:31:58.341 ERROR 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [ca8f7c15-48d5-4841-86d4-39788922f564] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.commandhandling.NoHandlerForCommandException: No Handler for command: com.airscholar.CommonService.commands.ValidatePaymentCommand
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$10(ErrorCode.java:84) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 15:34:16.288  INFO 91501 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 15:34:16.292  INFO 91501 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 15:34:16.322  INFO 91501 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 15:34:16.323  INFO 91501 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 15:34:16.821  INFO 91501 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:34:16.821  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 15:34:16.827  INFO 91501 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:34:16.827  INFO 91501 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 15:34:16.860  INFO 91501 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:34:16.861  INFO 91501 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:34:17.369  INFO 91501 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:34:17.378  INFO 91501 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 15:34:17.435  INFO 91501 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 15:34:24.033  INFO 91810 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 91810 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:34:24.036  INFO 91810 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:34:24.970  INFO 91810 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:34:25.142  INFO 91810 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 165 ms. Found 1 JPA repository interfaces.
2022-12-19 15:34:25.875  INFO 91810 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:34:25.881  INFO 91810 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:34:25.881  INFO 91810 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:34:26.030  INFO 91810 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:34:26.031  INFO 91810 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1888 ms
2022-12-19 15:34:26.082  INFO 91810 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:34:26.261  INFO 91810 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:34:26.273  INFO 91810 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:34:26.456  INFO 91810 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:34:26.485  INFO 91810 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:34:26.575  INFO 91810 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:34:26.634  INFO 91810 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:34:27.167  INFO 91810 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:34:27.171  INFO 91810 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:34:27.326  INFO 91810 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:34:27.448  INFO 91810 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:34:27.448  INFO 91810 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:34:27.448  INFO 91810 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:34:27.449  INFO 91810 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:34:27.449  INFO 91810 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:34:27.456  INFO 91810 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:34:27.456  INFO 91810 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:34:27.456  INFO 91810 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:34:27.457  INFO 91810 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:34:27.747  WARN 91810 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:34:28.164  INFO 91810 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:34:28.538  INFO 91810 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:34:28.736  INFO 91810 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:34:28.744  INFO 91810 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:34:28.756  INFO 91810 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:34:28.758  INFO 91810 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:34:28.761  INFO 91810 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:34:28.836  INFO 91810 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:34:28.836  INFO 91810 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:34:28.856  INFO 91810 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:34:28.854  INFO 91810 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.281 seconds (JVM running for 6.099)
2022-12-19 15:34:28.856  INFO 91810 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:34:28.869  INFO 91810 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=21} for segment: Segment[0/0]
2022-12-19 15:34:28.870  INFO 91810 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=21} for segment: Segment[0/0]
2022-12-19 15:34:43.437  INFO 91810 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:34:43.438  INFO 91810 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:34:43.453  INFO 91810 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 15 ms
2022-12-19 15:34:43.623  INFO 91810 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:59:23.721  INFO 94982 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 94982 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 15:59:23.731  INFO 94982 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 15:59:24.815  INFO 94982 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 15:59:24.963  INFO 94982 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 142 ms. Found 1 JPA repository interfaces.
2022-12-19 15:59:25.721  INFO 94982 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 15:59:25.732  INFO 94982 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 15:59:25.732  INFO 94982 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 15:59:25.885  INFO 94982 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 15:59:25.886  INFO 94982 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2015 ms
2022-12-19 15:59:25.925  INFO 94982 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 15:59:26.176  INFO 94982 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 15:59:26.205  INFO 94982 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 15:59:26.410  INFO 94982 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 15:59:26.446  INFO 94982 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 15:59:26.549  INFO 94982 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 15:59:26.616  INFO 94982 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 15:59:27.237  INFO 94982 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 15:59:27.253  INFO 94982 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 15:59:27.806  INFO 94982 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 15:59:28.222  INFO 94982 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 15:59:28.222  INFO 94982 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 15:59:28.222  INFO 94982 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 15:59:28.223  INFO 94982 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 15:59:28.223  INFO 94982 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 15:59:28.246  INFO 94982 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:59:28.247  INFO 94982 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 15:59:28.248  INFO 94982 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 15:59:28.250  INFO 94982 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 15:59:29.162  WARN 94982 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 15:59:29.729  INFO 94982 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 15:59:30.182  INFO 94982 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 15:59:30.627  INFO 94982 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 15:59:30.636  INFO 94982 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 15:59:30.653  INFO 94982 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 15:59:30.656  INFO 94982 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 15:59:30.661  INFO 94982 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 15:59:30.806  INFO 94982 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:59:30.806  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 15:59:30.830  INFO 94982 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 15:59:30.830  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 15:59:30.827  INFO 94982 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 7.609 seconds (JVM running for 8.503)
2022-12-19 15:59:30.849  INFO 94982 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=21} for segment: Segment[0/0]
2022-12-19 15:59:30.850  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=21} for segment: Segment[0/0]
2022-12-19 15:59:57.863  INFO 94982 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 15:59:57.871  INFO 94982 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 15:59:57.909  INFO 94982 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 38 ms
2022-12-19 15:59:58.880  INFO 94982 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 15:59:59.405  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 826001e4-5a84-4ad3-a4f3-b7a0183f432f
2022-12-19 15:59:59.407  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:05:03.166 ERROR 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [c5901759-3838-480c-a5d8-f7f4b63260b8] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.commandhandling.CommandExecutionException: Cancelled by AxonServer due to timeout
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$11(ErrorCode.java:91) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: org.axonframework.axonserver.connector.command.AxonServerRemoteCommandHandlingException: An exception was thrown by the remote message handling component: 
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$11(ErrorCode.java:89) ~[axon-server-connector-4.6.0.jar:4.6.0]
	... 16 common frames omitted

2022-12-19 16:05:05.615  INFO 94982 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:05:05.616  INFO 94982 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:05:05.654  INFO 94982 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:05:05.655  INFO 94982 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:05:06.423  INFO 94982 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:05:06.423  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:05:06.425  INFO 94982 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:05:06.425  INFO 94982 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:05:06.453  INFO 94982 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:05:06.453  INFO 94982 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:05:06.709  INFO 94982 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:05:06.716  INFO 94982 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:05:06.750  INFO 94982 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:05:15.035  INFO 95639 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 95639 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:05:15.038  INFO 95639 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:05:16.059  INFO 95639 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:05:16.211  INFO 95639 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 145 ms. Found 1 JPA repository interfaces.
2022-12-19 16:05:16.951  INFO 95639 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:05:16.957  INFO 95639 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:05:16.957  INFO 95639 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:05:17.073  INFO 95639 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:05:17.074  INFO 95639 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1943 ms
2022-12-19 16:05:17.112  INFO 95639 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:05:17.338  INFO 95639 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:05:17.353  INFO 95639 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:05:17.548  INFO 95639 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:05:17.579  INFO 95639 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:05:17.695  INFO 95639 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:05:17.755  INFO 95639 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:05:18.287  INFO 95639 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:05:18.291  INFO 95639 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:05:18.436  INFO 95639 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:05:18.568  INFO 95639 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:05:18.568  INFO 95639 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:05:18.568  INFO 95639 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:05:18.568  INFO 95639 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:05:18.568  INFO 95639 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:05:18.577  INFO 95639 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:05:18.578  INFO 95639 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:05:18.578  INFO 95639 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:05:18.578  INFO 95639 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:05:18.876  WARN 95639 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:05:19.320  INFO 95639 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:05:19.769  INFO 95639 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:05:19.991  INFO 95639 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:05:19.999  INFO 95639 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:05:20.010  INFO 95639 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:05:20.012  INFO 95639 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:05:20.016  INFO 95639 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:05:20.099  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:05:20.099  INFO 95639 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:05:20.113  INFO 95639 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.494 seconds (JVM running for 6.437)
2022-12-19 16:05:20.115  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:05:20.115  INFO 95639 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:05:20.124  INFO 95639 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=22} for segment: Segment[0/0]
2022-12-19 16:05:20.124  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=22} for segment: Segment[0/0]
2022-12-19 16:05:36.234  INFO 95639 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 16:05:36.235  INFO 95639 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 16:05:36.242  INFO 95639 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 7 ms
2022-12-19 16:05:36.417  INFO 95639 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:05:36.418  INFO 95639 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:05:36.549  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: ecc4c0e4-490b-4ecc-b5fd-db6900b8e5b6
2022-12-19 16:05:36.550  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:10:38.484 ERROR 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [358eb13f-d217-4a9b-a431-be185be68eb6] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.commandhandling.CommandExecutionException: Cancelled by AxonServer due to timeout
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$11(ErrorCode.java:91) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: org.axonframework.axonserver.connector.command.AxonServerRemoteCommandHandlingException: An exception was thrown by the remote message handling component: 
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$11(ErrorCode.java:89) ~[axon-server-connector-4.6.0.jar:4.6.0]
	... 16 common frames omitted

2022-12-19 16:11:58.736  INFO 95639 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:11:58.738  INFO 95639 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:11:58.776  INFO 95639 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:11:58.776  INFO 95639 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:11:59.284  INFO 95639 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:11:59.284  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:11:59.287  INFO 95639 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:11:59.287  INFO 95639 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:11:59.312  INFO 95639 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:11:59.313  INFO 95639 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:11:59.653  INFO 95639 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:11:59.672  INFO 95639 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:11:59.714  INFO 95639 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:12:09.682  INFO 96385 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 96385 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:12:09.684  INFO 96385 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:12:10.764  INFO 96385 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:12:10.933  INFO 96385 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 162 ms. Found 1 JPA repository interfaces.
2022-12-19 16:12:11.683  INFO 96385 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:12:11.690  INFO 96385 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:12:11.691  INFO 96385 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:12:11.813  INFO 96385 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:12:11.814  INFO 96385 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1948 ms
2022-12-19 16:12:11.849  INFO 96385 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:12:12.097  INFO 96385 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:12:12.112  INFO 96385 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:12:12.312  INFO 96385 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:12:12.350  INFO 96385 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:12:12.444  INFO 96385 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:12:12.508  INFO 96385 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:12:13.139  INFO 96385 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:12:13.144  INFO 96385 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:12:13.314  INFO 96385 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:12:13.459  INFO 96385 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:12:13.460  INFO 96385 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:12:13.460  INFO 96385 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:12:13.460  INFO 96385 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:12:13.460  INFO 96385 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:12:13.468  INFO 96385 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:12:13.469  INFO 96385 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:12:13.469  INFO 96385 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:12:13.470  INFO 96385 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:12:13.778  WARN 96385 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:12:14.335  INFO 96385 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:12:14.728  INFO 96385 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:12:15.015  INFO 96385 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:12:15.026  INFO 96385 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:12:15.043  INFO 96385 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:12:15.056  INFO 96385 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:12:15.067  INFO 96385 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:12:15.221  INFO 96385 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:12:15.221  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:12:15.264  INFO 96385 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:12:15.264  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:12:15.270  INFO 96385 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 6.111 seconds (JVM running for 7.12)
2022-12-19 16:12:15.280  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=23} for segment: Segment[0/0]
2022-12-19 16:12:15.281  INFO 96385 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=23} for segment: Segment[0/0]
2022-12-19 16:14:41.338  INFO 96385 --- [http-nio-9091-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 16:14:41.343  INFO 96385 --- [http-nio-9091-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 16:14:41.367  INFO 96385 --- [http-nio-9091-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 24 ms
2022-12-19 16:14:41.681  INFO 96385 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:14:41.681  INFO 96385 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:14:41.871  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: c212aaea-ae13-4615-89d0-f064c61552ce
2022-12-19 16:14:41.871  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:14:41.877  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:16:48.546 ERROR 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [bee83c04-ed76-4de9-b911-54ac95ec2060] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.axonserver.connector.AxonServerException: Connection lost while executing command on: 96638@ed-dynamic-158-197.wless.cranfield.ac.uk
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$26(ErrorCode.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 16:17:06.615  INFO 96385 --- [CommandProcessor-1] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:17:06.619  INFO 96385 --- [CommandProcessor-1] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:17:06.756  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 549e92ad-2907-477f-b307-218254c19ab7
2022-12-19 16:17:06.757  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:17:06.757  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:17:40.235 ERROR 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [f07e9d50-5d5e-4060-97b1-3c61668cf6e0] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.axonserver.connector.AxonServerException: Connection lost while executing command on: 96913@ed-dynamic-158-197.wless.cranfield.ac.uk
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$26(ErrorCode.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 16:17:56.041  INFO 96385 --- [CommandProcessor-2] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:17:56.042  INFO 96385 --- [CommandProcessor-2] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:17:56.073  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: d3a0d81b-b23a-42a7-8383-6d971ef90df9
2022-12-19 16:17:56.075  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:17:56.075  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:18:55.155 ERROR 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [9ca08b53-7656-4b73-83bb-7375157049ea] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.axonserver.connector.AxonServerException: Connection lost while executing command on: 97011@ed-dynamic-158-197.wless.cranfield.ac.uk
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$26(ErrorCode.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 16:20:19.124  INFO 96385 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:20:19.128  INFO 96385 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:20:19.162  INFO 96385 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:20:19.162  INFO 96385 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:20:19.554  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:20:19.554  INFO 96385 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:20:19.557  INFO 96385 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:20:19.557  INFO 96385 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:20:19.577  INFO 96385 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:20:19.578  INFO 96385 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:20:20.106  INFO 96385 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:20:20.117  INFO 96385 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:20:20.133  INFO 96385 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:20:30.213  INFO 97367 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 97367 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:20:30.217  INFO 97367 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:20:31.378  INFO 97367 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:20:31.546  INFO 97367 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 162 ms. Found 1 JPA repository interfaces.
2022-12-19 16:20:32.340  INFO 97367 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:20:32.347  INFO 97367 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:20:32.347  INFO 97367 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:20:32.475  INFO 97367 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:20:32.475  INFO 97367 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1985 ms
2022-12-19 16:20:32.513  INFO 97367 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:20:32.863  INFO 97367 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:20:32.929  INFO 97367 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:20:33.460  INFO 97367 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:20:33.570  INFO 97367 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:20:33.870  INFO 97367 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:20:34.065  INFO 97367 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:20:34.904  INFO 97367 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:20:34.913  INFO 97367 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:20:35.158  INFO 97367 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:20:35.423  INFO 97367 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:20:35.424  INFO 97367 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:20:35.425  INFO 97367 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:20:35.425  INFO 97367 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:20:35.425  INFO 97367 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:20:35.438  INFO 97367 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:20:35.439  INFO 97367 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:20:35.439  INFO 97367 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:20:35.440  INFO 97367 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:20:35.956  WARN 97367 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:20:36.602  INFO 97367 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:20:37.106  INFO 97367 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:20:37.338  INFO 97367 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:20:37.347  INFO 97367 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:20:37.360  INFO 97367 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:20:37.362  INFO 97367 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:20:37.366  INFO 97367 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:20:37.464  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:20:37.464  INFO 97367 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:20:37.483  INFO 97367 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:20:37.483  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:20:37.503  INFO 97367 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=26} for segment: Segment[0/0]
2022-12-19 16:20:37.503  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=26} for segment: Segment[0/0]
2022-12-19 16:20:37.508  INFO 97367 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 7.787 seconds (JVM running for 8.662)
2022-12-19 16:21:25.687  INFO 97367 --- [http-nio-9091-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 16:21:25.769  INFO 97367 --- [http-nio-9091-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 16:21:25.820  INFO 97367 --- [http-nio-9091-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 49 ms
2022-12-19 16:21:26.343  INFO 97367 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:21:26.344  INFO 97367 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:21:26.485  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 8fa9c9ea-e85b-455d-a360-d8c2bbe56373
2022-12-19 16:21:26.486  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:21:26.488  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:22:26.903 ERROR 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [07183ba0-bbfb-452f-b783-6bed181bf3e3] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.axonserver.connector.AxonServerException: Connection lost while executing command on: 97197@ed-dynamic-158-197.wless.cranfield.ac.uk
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$26(ErrorCode.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 16:22:46.844  INFO 97367 --- [CommandProcessor-1] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:22:46.847  INFO 97367 --- [CommandProcessor-1] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:22:47.007  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 6e5582e3-0bfa-4d6d-8b12-7a8868324bae
2022-12-19 16:22:47.010  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:22:47.011  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:23:02.075 ERROR 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [e67054c7-1dc2-4dfd-af9b-20ddcd7d73a1] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.axonserver.connector.AxonServerException: Connection lost while executing command on: 97611@ed-dynamic-158-197.wless.cranfield.ac.uk
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$26(ErrorCode.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 16:27:56.589  INFO 97367 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:27:56.645  INFO 97367 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:27:56.745  INFO 97367 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:27:56.751  INFO 97367 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:27:57.368  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:27:57.368  INFO 97367 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:27:57.374  INFO 97367 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:27:57.374  INFO 97367 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:27:57.440  INFO 97367 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:27:57.443  INFO 97367 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:27:58.122  INFO 97367 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:27:58.139  INFO 97367 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:27:58.214  INFO 97367 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:28:08.986  INFO 98251 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 98251 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:28:09.014  INFO 98251 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:28:10.165  INFO 98251 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:28:10.404  INFO 98251 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 228 ms. Found 1 JPA repository interfaces.
2022-12-19 16:28:11.499  INFO 98251 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:28:11.512  INFO 98251 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:28:11.513  INFO 98251 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:28:11.862  INFO 98251 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:28:11.866  INFO 98251 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2733 ms
2022-12-19 16:28:12.202  INFO 98251 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:28:13.190  INFO 98251 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:28:13.241  INFO 98251 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:28:14.048  INFO 98251 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:28:14.144  INFO 98251 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:28:14.374  INFO 98251 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:28:14.509  INFO 98251 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:28:15.469  INFO 98251 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:28:15.475  INFO 98251 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:28:15.727  INFO 98251 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:28:15.932  INFO 98251 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:28:15.933  INFO 98251 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:28:15.933  INFO 98251 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:28:15.933  INFO 98251 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:28:15.933  INFO 98251 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:28:15.944  INFO 98251 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:28:15.945  INFO 98251 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:28:15.945  INFO 98251 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:28:15.946  INFO 98251 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:28:16.600  WARN 98251 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:28:17.296  INFO 98251 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:28:17.820  INFO 98251 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:28:18.185  INFO 98251 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:28:18.199  INFO 98251 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:28:18.233  INFO 98251 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:28:18.241  INFO 98251 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:28:18.274  INFO 98251 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:28:18.505  INFO 98251 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:28:18.505  INFO 98251 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:28:18.536  INFO 98251 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 10.081 seconds (JVM running for 11.408)
2022-12-19 16:28:18.548  INFO 98251 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:28:18.548  INFO 98251 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:28:18.564  INFO 98251 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=28} for segment: Segment[0/0]
2022-12-19 16:28:18.564  INFO 98251 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=28} for segment: Segment[0/0]
2022-12-19 16:40:11.287  INFO 98251 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:40:11.324  INFO 98251 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:40:11.482  INFO 98251 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:40:11.486  INFO 98251 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:40:12.651  INFO 98251 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:40:12.651  INFO 98251 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:40:12.656  INFO 98251 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:40:12.656  INFO 98251 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:40:12.726  INFO 98251 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:40:12.728  INFO 98251 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:40:13.072  INFO 98251 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:40:13.112  INFO 98251 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:40:13.217  INFO 98251 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:40:27.906  INFO 99684 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 99684 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:40:27.911  INFO 99684 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:40:29.071  INFO 99684 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:40:29.302  INFO 99684 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 222 ms. Found 1 JPA repository interfaces.
2022-12-19 16:40:30.522  INFO 99684 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:40:30.538  INFO 99684 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:40:30.539  INFO 99684 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:40:30.864  INFO 99684 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:40:30.864  INFO 99684 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2862 ms
2022-12-19 16:40:30.979  INFO 99684 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:40:31.865  INFO 99684 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:40:31.942  INFO 99684 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:40:32.932  INFO 99684 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:40:33.031  INFO 99684 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:40:33.427  INFO 99684 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:40:33.585  INFO 99684 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:40:34.530  INFO 99684 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:40:34.537  INFO 99684 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:40:34.797  INFO 99684 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:40:35.032  INFO 99684 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:40:35.033  INFO 99684 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:40:35.034  INFO 99684 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:40:35.034  INFO 99684 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:40:35.034  INFO 99684 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:40:35.055  INFO 99684 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:40:35.058  INFO 99684 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:40:35.059  INFO 99684 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:40:35.061  INFO 99684 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:40:35.609  WARN 99684 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:40:36.288  INFO 99684 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:40:36.925  INFO 99684 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:40:37.349  INFO 99684 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:40:37.360  INFO 99684 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:40:37.388  INFO 99684 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:40:37.393  INFO 99684 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:40:37.397  INFO 99684 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:40:37.537  INFO 99684 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:40:37.537  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:40:37.583  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:40:37.577  INFO 99684 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 10.204 seconds (JVM running for 12.22)
2022-12-19 16:40:37.583  INFO 99684 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:40:37.607  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=28} for segment: Segment[0/0]
2022-12-19 16:40:37.607  INFO 99684 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=28} for segment: Segment[0/0]
2022-12-19 16:41:19.043  INFO 99684 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 16:41:19.047  INFO 99684 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 16:41:19.083  INFO 99684 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 36 ms
2022-12-19 16:41:19.629  INFO 99684 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:41:19.632  INFO 99684 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:41:19.997  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 7a3642d0-6635-45d4-816c-683943501db0
2022-12-19 16:41:20.009  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:41:20.015  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:44:31.185  INFO 99684 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:44:31.194  INFO 99684 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:44:31.287  INFO 99684 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:44:31.287  INFO 99684 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:44:31.775  INFO 99684 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:44:31.779  INFO 99684 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:44:36.298  WARN 99684 --- [SpringApplicationShutdownHook] o.a.config.DefaultConfigurer             : Timed out during shutdown phase [1073741823] after 5 second(s). Proceeding to following phase
2022-12-19 16:44:36.373  INFO 99684 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:44:36.382  INFO 99684 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:44:36.394  WARN 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 90121, SQLState: 90121
2022-12-19 16:44:36.395 ERROR 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.h.engine.jdbc.spi.SqlExceptionHelper   : Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-214]
2022-12-19 16:44:36.436  WARN 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 90121, SQLState: 90121
2022-12-19 16:44:36.437 ERROR 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.h.engine.jdbc.spi.SqlExceptionHelper   : Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-214]
2022-12-19 16:44:36.461 ERROR 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.s.orm.jpa.EntityManagerFactoryUtils    : Failed to release JPA EntityManager

org.hibernate.exception.JDBCConnectionException: Unable to release JDBC Connection
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:48) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:99) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:223) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.close(LogicalConnectionManagedImpl.java:261) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.close(JdbcCoordinatorImpl.java:175) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.internal.AbstractSharedSessionContract.close(AbstractSharedSessionContract.java:374) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.internal.SessionImpl.closeWithoutOpenChecks(SessionImpl.java:413) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.internal.SessionImpl.close(SessionImpl.java:398) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.springframework.orm.jpa.EntityManagerFactoryUtils.closeEntityManager(EntityManagerFactoryUtils.java:427) ~[spring-orm-5.3.22.jar:5.3.22]
	at org.springframework.orm.jpa.JpaTransactionManager.doCleanupAfterCompletion(JpaTransactionManager.java:650) ~[spring-orm-5.3.22.jar:5.3.22]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.cleanupAfterCompletion(AbstractPlatformTransactionManager.java:992) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:875) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:809) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.axonframework.spring.messaging.unitofwork.SpringTransactionManager.rollbackTransaction(SpringTransactionManager.java:97) ~[axon-spring-4.6.0.jar:4.6.0]
	at org.axonframework.spring.messaging.unitofwork.SpringTransactionManager$1.rollback(SpringTransactionManager.java:74) ~[axon-spring-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.UnitOfWork.lambda$attachTransaction$1(UnitOfWork.java:275) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.MessageProcessingContext.notifyHandlers(MessageProcessingContext.java:72) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.lambda$notifyHandlers$2(BatchingUnitOfWork.java:161) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.util.Iterator.forEachRemaining(Iterator.java:133) ~[na:na]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.notifyHandlers(BatchingUnitOfWork.java:161) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.changePhase(AbstractUnitOfWork.java:236) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.commitAsRoot(AbstractUnitOfWork.java:90) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.commit(AbstractUnitOfWork.java:75) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:117) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:678) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:223) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:199) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:188) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1375) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.jdbc.JdbcConnection.rollback(JdbcConnection.java:463) ~[h2-2.1.214.jar:2.1.214]
	at com.zaxxer.hikari.pool.ProxyConnection.close(ProxyConnection.java:257) ~[HikariCP-4.0.3.jar:na]
	at org.hibernate.engine.jdbc.connections.internal.DatasourceConnectionProviderImpl.closeConnection(DatasourceConnectionProviderImpl.java:127) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.internal.NonContextualJdbcConnectionAccess.releaseConnection(NonContextualJdbcConnectionAccess.java:49) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.resource.jdbc.internal.LogicalConnectionManagedImpl.releaseConnection(LogicalConnectionManagedImpl.java:219) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	... 28 common frames omitted

2022-12-19 16:44:36.468  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.m.u.MessageProcessingContext         : An error occurred while executing a lifecycle phase handler for phase ROLLBACK

org.springframework.transaction.TransactionSystemException: Could not roll back JPA transaction; nested exception is org.hibernate.TransactionException: Unable to rollback against JDBC Connection
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:593) ~[spring-orm-5.3.22.jar:5.3.22]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:835) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:809) ~[spring-tx-5.3.22.jar:5.3.22]
	at org.axonframework.spring.messaging.unitofwork.SpringTransactionManager.rollbackTransaction(SpringTransactionManager.java:97) ~[axon-spring-4.6.0.jar:4.6.0]
	at org.axonframework.spring.messaging.unitofwork.SpringTransactionManager$1.rollback(SpringTransactionManager.java:74) ~[axon-spring-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.UnitOfWork.lambda$attachTransaction$1(UnitOfWork.java:275) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.MessageProcessingContext.notifyHandlers(MessageProcessingContext.java:72) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.lambda$notifyHandlers$2(BatchingUnitOfWork.java:161) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.util.Iterator.forEachRemaining(Iterator.java:133) ~[na:na]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.notifyHandlers(BatchingUnitOfWork.java:161) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.changePhase(AbstractUnitOfWork.java:236) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.commitAsRoot(AbstractUnitOfWork.java:90) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.commit(AbstractUnitOfWork.java:75) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:117) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: org.hibernate.TransactionException: Unable to rollback against JDBC Connection
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:127) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.rollback(JdbcResourceLocalTransactionCoordinatorImpl.java:304) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.rollback(TransactionImpl.java:142) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:589) ~[spring-orm-5.3.22.jar:5.3.22]
	... 20 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:678) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:223) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:199) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:188) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1375) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.jdbc.JdbcConnection.rollback(JdbcConnection.java:463) ~[h2-2.1.214.jar:2.1.214]
	at com.zaxxer.hikari.pool.ProxyConnection.rollback(ProxyConnection.java:396) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyConnection.rollback(HikariProxyConnection.java) ~[HikariCP-4.0.3.jar:na]
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:121) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	... 23 common frames omitted

2022-12-19 16:44:36.476  WARN 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Error occurred. Starting retry mode.

javax.persistence.PersistenceException: org.hibernate.exception.JDBCConnectionException: could not prepare statement
	at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:154) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:181) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1705) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.axonframework.eventhandling.tokenstore.jpa.JpaTokenStore.extendClaim(JpaTokenStore.java:226) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.lambda$null$0(TrackingEventProcessor.java:175) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.MessageProcessingContext.notifyHandlers(MessageProcessingContext.java:72) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.lambda$notifyHandlers$2(BatchingUnitOfWork.java:161) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.util.ArrayList$Itr.forEachRemaining(ArrayList.java:1003) ~[na:na]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.notifyHandlers(BatchingUnitOfWork.java:161) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.changePhase(AbstractUnitOfWork.java:236) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.commitAsRoot(AbstractUnitOfWork.java:87) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.AbstractUnitOfWork.commit(AbstractUnitOfWork.java:75) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.messaging.unitofwork.BatchingUnitOfWork.executeWithResult(BatchingUnitOfWork.java:117) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.AbstractEventProcessor.processInUnitOfWork(AbstractEventProcessor.java:166) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processBatch(TrackingEventProcessor.java:490) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor.processingLoop(TrackingEventProcessor.java:318) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$TrackingSegmentWorker.run(TrackingEventProcessor.java:1145) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.cleanUp(TrackingEventProcessor.java:1340) ~[axon-messaging-4.6.0.jar:4.6.0]
	at org.axonframework.eventhandling.TrackingEventProcessor$WorkerLauncher.run(TrackingEventProcessor.java:1317) ~[axon-messaging-4.6.0.jar:4.6.0]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: org.hibernate.exception.JDBCConnectionException: could not prepare statement
	at org.hibernate.exception.internal.SQLExceptionTypeDelegate.convert(SQLExceptionTypeDelegate.java:48) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:37) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:113) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:186) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareStatement(StatementPreparerImpl.java:81) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.hql.internal.ast.exec.BasicExecutor.doExecute(BasicExecutor.java:68) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.hql.internal.ast.exec.BasicExecutor.execute(BasicExecutor.java:50) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.hql.internal.ast.QueryTranslatorImpl.executeUpdate(QueryTranslatorImpl.java:458) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.query.spi.HQLQueryPlan.performExecuteUpdate(HQLQueryPlan.java:377) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.internal.SessionImpl.executeUpdate(SessionImpl.java:1483) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.query.internal.AbstractProducedQuery.doExecuteUpdate(AbstractProducedQuery.java:1714) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.query.internal.AbstractProducedQuery.executeUpdate(AbstractProducedQuery.java:1696) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	... 17 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:678) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:223) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:199) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.message.DbException.get(DbException.java:188) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.jdbc.JdbcConnection.checkClosed(JdbcConnection.java:1375) ~[h2-2.1.214.jar:2.1.214]
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:286) ~[h2-2.1.214.jar:2.1.214]
	at com.zaxxer.hikari.pool.ProxyConnection.prepareStatement(ProxyConnection.java:337) ~[HikariCP-4.0.3.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyConnection.prepareStatement(HikariProxyConnection.java) ~[HikariCP-4.0.3.jar:na]
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$1.doPrepare(StatementPreparerImpl.java:90) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	at org.hibernate.engine.jdbc.internal.StatementPreparerImpl$StatementPreparationTemplate.prepareStatement(StatementPreparerImpl.java:176) ~[hibernate-core-5.6.10.Final.jar:5.6.10.Final]
	... 25 common frames omitted

2022-12-19 16:44:36.484  WARN 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Releasing claim on token and preparing for retry in 1s
2022-12-19 16:44:36.501  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:44:36.503  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:44:36.503  INFO 99684 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:44:41.393  WARN 99684 --- [SpringApplicationShutdownHook] o.a.config.DefaultConfigurer             : Timed out during shutdown phase [0] after 5 second(s). Proceeding to following phase
2022-12-19 16:44:43.466  INFO 99684 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:44:43.492  INFO 99684 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:44:43.526  INFO 99684 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:44:54.204  INFO 302 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 302 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:44:54.227  INFO 302 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:44:55.398  INFO 302 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:44:55.674  INFO 302 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 265 ms. Found 1 JPA repository interfaces.
2022-12-19 16:44:56.764  INFO 302 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:44:56.772  INFO 302 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:44:56.773  INFO 302 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:44:56.915  INFO 302 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:44:56.915  INFO 302 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2613 ms
2022-12-19 16:44:56.987  INFO 302 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:44:57.334  INFO 302 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:44:57.351  INFO 302 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:44:57.766  INFO 302 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:44:57.804  INFO 302 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:44:57.913  INFO 302 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:44:57.996  INFO 302 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:44:58.844  INFO 302 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:44:58.850  INFO 302 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:44:59.046  INFO 302 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:44:59.197  INFO 302 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:44:59.198  INFO 302 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:44:59.198  INFO 302 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:44:59.198  INFO 302 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:44:59.198  INFO 302 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:44:59.207  INFO 302 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:44:59.207  INFO 302 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:44:59.207  INFO 302 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:44:59.208  INFO 302 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:44:59.615  WARN 302 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:45:00.454  INFO 302 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:45:00.900  INFO 302 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:45:01.145  INFO 302 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:45:01.160  INFO 302 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:45:01.184  INFO 302 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:45:01.186  INFO 302 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:45:01.191  INFO 302 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:45:01.328  INFO 302 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:45:01.330  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:45:01.350  INFO 302 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 7.671 seconds (JVM running for 9.503)
2022-12-19 16:45:01.350  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:45:01.350  INFO 302 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:45:01.371  INFO 302 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=29} for segment: Segment[0/0]
2022-12-19 16:45:01.370  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=28} for segment: Segment[0/0]
2022-12-19 16:45:01.515  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 7a3642d0-6635-45d4-816c-683943501db0
2022-12-19 16:45:01.515  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:45:01.517  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:45:01.558 ERROR 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [b9309a50-c9b5-4795-824a-e0e7f4b08d89] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.commandhandling.NoHandlerForCommandException: No Handler for command: com.airscholar.CommonService.commands.ValidatePaymentCommand
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$10(ErrorCode.java:84) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]

2022-12-19 16:45:36.366  INFO 302 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:45:36.368  INFO 302 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:45:36.375  INFO 302 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:45:36.376  INFO 302 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:45:36.784  INFO 302 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:45:36.785  INFO 302 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:45:36.847  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:45:36.848  INFO 302 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:45:36.858  INFO 302 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:45:36.858  INFO 302 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:45:37.287  INFO 302 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:45:37.290  INFO 302 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:45:37.303  INFO 302 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-12-19 16:45:47.008  INFO 444 --- [main] c.a.O.OrderServiceApplication            : Starting OrderServiceApplication using Java 17.0.1 on ed-dynamic-158-197.wless.cranfield.ac.uk with PID 444 (/Users/airscholar/IdeaProjects/OrderApp/OrderService/target/classes started by airscholar in /Users/airscholar/IdeaProjects/OrderApp)
2022-12-19 16:45:47.012  INFO 444 --- [main] c.a.O.OrderServiceApplication            : No active profile set, falling back to 1 default profile: "default"
2022-12-19 16:45:47.910  INFO 444 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-12-19 16:45:48.095  INFO 444 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 177 ms. Found 1 JPA repository interfaces.
2022-12-19 16:45:48.832  INFO 444 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 9091 (http)
2022-12-19 16:45:48.838  INFO 444 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-12-19 16:45:48.839  INFO 444 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-12-19 16:45:48.964  INFO 444 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-12-19 16:45:48.964  INFO 444 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1887 ms
2022-12-19 16:45:49.001  INFO 444 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-12-19 16:45:49.225  INFO 444 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-12-19 16:45:49.240  INFO 444 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:file:~/data/orderDB'
2022-12-19 16:45:49.436  INFO 444 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-12-19 16:45:49.469  INFO 444 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-12-19 16:45:49.562  INFO 444 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-12-19 16:45:49.615  INFO 444 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
2022-12-19 16:45:50.183  INFO 444 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-12-19 16:45:50.191  INFO 444 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:45:50.472  INFO 444 --- [main] o.a.s.a.XStreamAutoConfiguration         : Initializing an XStream instance since none was found. The auto configuration base packages will be used as wildcards for the XStream security settings.
2022-12-19 16:45:50.630  INFO 444 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [com.airscholar.OrderService].
2022-12-19 16:45:50.631  INFO 444 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.tokenstore].
2022-12-19 16:45:50.631  INFO 444 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventhandling.deadletter.jpa].
2022-12-19 16:45:50.631  INFO 444 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.modelling.saga.repository.jpa].
2022-12-19 16:45:50.631  INFO 444 --- [main] o.a.s.util.XStreamSecurityTypeUtility    : Constructing wildcard type for base package [org.axonframework.eventsourcing.eventstore.jpa].
2022-12-19 16:45:50.640  INFO 444 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:45:50.640  INFO 444 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-12-19 16:45:50.641  INFO 444 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-12-19 16:45:50.641  INFO 444 --- [main] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/ParsingException
2022-12-19 16:45:51.000  WARN 444 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-12-19 16:45:51.434  INFO 444 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 9091 (http) with context path ''
2022-12-19 16:45:51.781  INFO 444 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-12-19 16:45:51.944  INFO 444 --- [main] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-12-19 16:45:51.951  INFO 444 --- [main] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-12-19 16:45:51.960  INFO 444 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-12-19 16:45:51.961  INFO 444 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:45:51.963  INFO 444 --- [main] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:45:52.052  INFO 444 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:45:52.053  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-12-19 16:45:52.068  INFO 444 --- [main] c.a.O.OrderServiceApplication            : Started OrderServiceApplication in 5.599 seconds (JVM running for 6.623)
2022-12-19 16:45:52.070  INFO 444 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.airscholar.OrderService.command.api.events, segment=Segment[0/0]}
2022-12-19 16:45:52.070  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderProcessingSagaProcessor, segment=Segment[0/0]}
2022-12-19 16:45:52.081  INFO 444 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=29} for segment: Segment[0/0]
2022-12-19 16:45:52.081  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=29} for segment: Segment[0/0]
2022-12-19 16:46:01.794  INFO 444 --- [http-nio-9091-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-12-19 16:46:01.801  INFO 444 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-12-19 16:46:01.818  INFO 444 --- [http-nio-9091-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 17 ms
2022-12-19 16:46:02.137  INFO 444 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : Inside OrderAggregate CreateOrderCommand
2022-12-19 16:46:02.138  INFO 444 --- [CommandProcessor-0] c.a.O.c.api.Aggregate.OrderAggregate     : user id => 123
2022-12-19 16:46:02.490  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : OrderProcessingSaga started for orderId: 83cbdd84-c893-466d-bcb7-a0f9d61c474b
2022-12-19 16:46:02.509  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : USER ID GOES HERE => 123
2022-12-19 16:46:02.514  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] c.a.O.c.api.saga.OrderProcessingSaga     : Sending ValidatePaymentCommand to PaymentService
2022-12-19 16:51:05.340 ERROR 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.eventhandling.LoggingErrorHandler    : EventListener [AnnotatedSaga] failed to handle event [2c6090d7-5b43-45f7-8638-4eb0a6069ab4] (com.airscholar.OrderService.command.api.events.OrderCreatedEvent). Continuing processing with next listener

org.axonframework.commandhandling.CommandExecutionException: Cancelled by AxonServer due to timeout
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$11(ErrorCode.java:91) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:201) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.CommandSerializer.deserialize(CommandSerializer.java:164) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at org.axonframework.axonserver.connector.command.AxonServerCommandBus.lambda$doDispatch$2(AxonServerCommandBus.java:181) ~[axon-server-connector-4.6.0.jar:4.6.0]
	at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[na:na]
	at java.base/java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[na:na]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:369) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.axoniq.axonserver.connector.command.impl.CommandChannelImpl$CommandResponseHandler.onNext(CommandChannelImpl.java:356) ~[axonserver-connector-java-4.6.1.jar:4.6.1]
	at io.grpc.stub.ClientCalls$StreamObserverToCallListenerAdapter.onMessage(ClientCalls.java:466) ~[grpc-stub-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInternal(ClientCallImpl.java:661) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1MessagesAvailable.runInContext(ClientCallImpl.java:646) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.44.1.jar:1.44.1]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.44.1.jar:1.44.1]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:833) ~[na:na]
Caused by: org.axonframework.axonserver.connector.command.AxonServerRemoteCommandHandlingException: An exception was thrown by the remote message handling component: 
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$11(ErrorCode.java:89) ~[axon-server-connector-4.6.0.jar:4.6.0]
	... 16 common frames omitted

2022-12-19 16:52:18.011  INFO 444 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderProcessingSagaProcessor'.
2022-12-19 16:52:18.058  INFO 444 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderProcessingSagaProcessor' awaiting termination...
2022-12-19 16:52:18.328  INFO 444 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.airscholar.OrderService.command.api.events'.
2022-12-19 16:52:18.330  INFO 444 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.airscholar.OrderService.command.api.events' awaiting termination...
2022-12-19 16:52:20.200  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:52:20.200  INFO 444 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-12-19 16:52:20.231  INFO 444 --- [EventProcessor[com.airscholar.OrderService.command.api.events]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:52:20.229  INFO 444 --- [EventProcessor[OrderProcessingSagaProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-12-19 16:52:20.456  INFO 444 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.OrderService.command.api.command.CreateOrderCommand' in context 'default'
2022-12-19 16:52:20.460  INFO 444 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.airscholar.CommonService.commands.CompleteOrderCommand' in context 'default'
2022-12-19 16:52:21.068  INFO 444 --- [SpringApplicationShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2022-12-19 16:52:21.101  INFO 444 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-12-19 16:52:21.172  INFO 444 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
